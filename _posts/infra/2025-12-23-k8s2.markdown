---
layout: content-layout
title: "ì¿ ë²„ë„¤í‹°ìŠ¤ ê°„ë‹¨í•˜ê²Œ ì„¤ì¹˜í•´ë³´ê¸°!ğŸ¤¤"
date: 2025-12-23
categories: [INFRA]
tags: [INFRA, Kubernetes, k8s, ì¿ ë²„ë„¤í‹°ìŠ¤]
---

## ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ! ğŸ˜€

ì§€ë‚œ ë²ˆ ë„ì»¤ì— ì´ì–´ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ë¦¬ëˆ…ìŠ¤ì— ê°„ë‹¨í•˜ê²Œ ì„¤ì¹˜í•´ë³´ëŠ” ì‹¤ìŠµì…ë‹ˆë‹¤!

---

### 1. containerd ì„¤ì • (K8s í•„ìˆ˜)
KubernetesëŠ” systemd cgroup ì„¤ì •ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.
```
sudo containerd config default | sudo tee /etc/containerd/config.toml
sudo sed -i 's/SystemdCgroup = false/SystemdCgroup = true/' \
/etc/containerd/config.toml
sudo systemctl restart containerd
```

### 2. Kubernetes ì„¤ì¹˜ (kubeadm ë°©ì‹)
#### 2-1. Kubernetes ì €ì¥ì†Œ ì¶”ê°€
```
curl -fsSL https://pkgs.k8s.io/core:/stable:/v1.30/deb/Release.key | \
sudo gpg --dearmor -o /etc/apt/keyrings/kubernetes-apt-keyring.gpg
```
```
echo "deb [signed-by=/etc/apt/keyrings/kubernetes-apt-keyring.gpg] \
https://pkgs.k8s.io/core:/stable:/v1.30/deb/ /" | \
sudo tee /etc/apt/sources.list.d/kubernetes.list
```
#### 2-2. kubeadm, kubelet, kubectl ì„¤ì¹˜
```
sudo apt update
sudo apt install -y kubelet kubeadm kubectl
sudo apt-mark hold kubelet kubeadm kubectl
```

### 3. í´ëŸ¬ìŠ¤í„° ì´ˆê¸°í™” (ì‹±ê¸€ ë…¸ë“œ)
```
sudo kubeadm init --pod-network-cidr=10.244.0.0/16
```
kubectl ì„¤ì •
```
mkdir -p $HOME/.kube
sudo cp /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config
```
í™•ì¸ (ìƒíƒœ NotReady)
```
kubectl get nodes
```

### 4. CNI ë„¤íŠ¸ì›Œí¬ ì„¤ì¹˜ (Flannel)
```
kubectl apply -f https://raw.githubusercontent.com/flannel-io/flannel/master/Documentation/kube-flannel.yml
```
ëª‡ ì´ˆ í›„: ìƒíƒœê°€ NotReadyì—ì„œ Readyë¡œ ë°”ë€Œì—ˆëŠ”ì§€ í™•ì¸
```
kubectl get nodes
```

### 5. ì‹±ê¸€ ë…¸ë“œì—ì„œ Pod ì‹¤í–‰ í—ˆìš©
```
kubectl taint nodes --all node-role.kubernetes.io/control-plane-
```

### 6. ì‹¤í–‰ í…ŒìŠ¤íŠ¸
```
kubectl create deployment nginx --image=nginx
kubectl expose deployment nginx --type=NodePort --port=80
kubectl get svc
```
í™•ì¸
```
kubectl get nodes
kubectl get pods -A
```
ë‹¤ìŒê³¼ ê°™ì´ Running ìƒíƒœë¡œ ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
```
vboxuser@vboxuser:~/Desktop$ kubectl get pods -n kube-system
NAME                               READY   STATUS    RESTARTS   AGE
coredns-55cb58b774-jvksb           1/1     Running   0          104s
coredns-55cb58b774-nfgdj           1/1     Running   0          104s
etcd-vboxuser                      1/1     Running   1          119s
kube-apiserver-vboxuser            1/1     Running   1          2m
kube-controller-manager-vboxuser   1/1     Running   1          119s
kube-proxy-c8wqr                   1/1     Running   0          104s
kube-scheduler-vboxuser            1/1     Running   1          119s
```

### ì¶”ê°€. K8S ëŒ€ì‹œë³´ë“œ ì„¤ì¹˜ (ì‹¤ë¬´ì—ì„œëŠ” ì˜ ì‚¬ìš© ì•ˆí•¨!!!)
```
kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.7.0/aio/deploy/recommended.yaml
```
#### ëŒ€ì‹œë³´ë“œ ì ‘ê·¼í•˜ê¸°
í”„ë¡ì‹œ ì—´ì–´ë‘ê¸°
```
kubectl proxy
```
ë¸Œë¼ìš°ì € ì—´ì–´ì„œ ë‹¤ìŒ URL ì ‘ì†
```
http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/
```
#### í† í° ìƒì„±
ìƒˆë¡œ í„°ë¯¸ë„ ì°½ í•˜ë‚˜ ë„ìš°ê¸°
```
cat <<EOF | kubectl apply -f -
apiVersion: v1
kind: ServiceAccount
metadata:
  name: admin-user
  namespace: kubernetes-dashboard
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: admin-user
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
- kind: ServiceAccount
  name: admin-user
  namespace: kubernetes-dashboard
EOF
```
ë‹¤ìŒìœ¼ë¡œ í† í° ë°œê¸‰í•˜ê¸° (í•„ìš”í• ë•Œë§ˆë‹¤ ìƒì„± ê°€ëŠ¥)
```
kubectl -n kubernetes-dashboard create token admin-user
```
ê²°ê³¼ë¡œ ë‚˜ì˜¨ Tokenì„ ë³µì‚¬í•˜ì—¬ ë¸Œë¼ìš°ì €ì— ë¶™ì—¬ë„£ê³  Tokenìœ¼ë¡œ ë¡œê·¸ì¸ ì§„í–‰í•˜ê¸°

ì•„ë˜ì²˜ëŸ¼ ëŒ€ì‹œë³´ë“œ í™”ë©´ ë‚˜ì˜¤ë©´ ìµœì¢… ì„±ê³µ

![ëŒ€ì‹œë³´ë“œ í™”ë©´](/assets/images/2025-12-23%2017%2028%2027.png)

---

ë‹¤ìŒì—ëŠ” ë‹¤ë¥¸ ê²ƒìœ¼ë¡œ ëŒì•„ì˜¤ê² ìŠµë‹ˆë‹¤!

ê¸´ ê¸€ ë´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤! ğŸ˜Œ